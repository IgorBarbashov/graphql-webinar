# graphql-webinar

## Шаг 1 в NodeJS

В данном примере мы рассматриваем самые простые способы использования GraphQL без сервера, без сложных типов и вложенных полей.

## Запуск

Для запуска достаточно установить зависимости.

```bash
npm i
```

И запустить скрипт простой командой

```bash
node index.js
```

## Что в данном примере происходит

В данном шаге мы решили проблему N+1. Для ее решения мы используем dataloader.

В резолвере вместо реальных данных мы возвращаем dataloader и передаем ему id нужной сущности

```javascript
async function (post) {
  return UsersLoader.load(post.userId)
}
```

Сам же лоадер определяется следующим образом

```javascript
const DataLoader = require('dataloader')
const UsersLoader = new DataLoader((userIds) => {
  return axios(`https://jsonplaceholder.typicode.com/users`).then(data => data.data.filter(user => userIds.includes(user.id)))
})
```

В данном примере мы, конечно, получаем избыточные данные с API, т.к. у нашего API нет функционала фильтрации. Поэтому мы фильтруем уже на своей стороне по id.
Суть в том, что в данный лоадер приходит запрос тогда, когда уже все поля с этим лоадером собраны и можно сделать разовый один запрос к внешнему сервису и разобрать полученные данные и передать их в нужные резолверы
